---
title: Soumettez le formulaire de mise √† jour
description: D√©couvrez comment soumettre un formulaire de mise √† jour dans une application Angular.
---

import { Steps } from '@astrojs/starlight/components';
import Objective from '../../../../../components/learning-objective.astro';

<Objective class="drop-shadow-xl" objectives={[
{mainTitle: 'Objectifs de ce chapitre', title: 'Soumettez le formulaire de mise √† jour', description: 'D√©couvrez comment soumettre un formulaire de mise √† jour dans une application Angular.'},
]} />

## Mettre √† jour la t√¢che avec le TaskService

Le service **TaskService** inclut d√©j√† une fonction permettant d'ajouter une nouvelle t√¢che √† la liste.
Ajoutons une nouvelle fonction pour mettre √† jour une t√¢che existante de la liste.

### üéì Instructions

<Steps>

1. Mettez √† jour le fichier `src/app/task-service.ts`.

   ```typescript ins={"Ajoutez la fonction de mise √† jour de la t√¢che": 32-36}
   import { Injectable } from '@angular/core';
   import { Task } from './task.model';

   @Injectable({
     providedIn: 'root'
   })
   export class TaskService {
       tasks: Task[] = [
           {
               title: 'T√¢che 1',
               description: 'Description de la t√¢che 1',
               createdAt: new Date()
           },
           {
               title: 'T√¢che 2',
               description: 'Description de la t√¢che 2',
               createdAt: new Date()
           }
       ];

       addTask(task: Task) {
           this.tasks.push({
               ...task,
               createdAt: new Date()
           });
       }

     getTask(id: string) {
       return this.tasks.find(task => task.id === id);
     }


     updateTask(task: Task) {
       const index = this.tasks.findIndex(t => t.id === task.id);
       this.tasks[index] = task;
     }
   }
   ```

</Steps>

## Mettez √† jour le TaskFormComponent

Le composant **TaskFormComponent** est actuellement utilis√© pour ajouter une nouvelle t√¢che √† la liste.

G√©rez l'action de mise √† jour via le formulaire sans cr√©er une nouvelle t√¢che.
Pour ce faire, conservez la m√™me fonction **submit** mais mettez-la √† jour pour utiliser la fonction **updateTask** du service **TaskService**.

Quand?

- Si la t√¢che a un **id**, appelez la fonction **updateTask**.
- Si la t√¢che n'a pas d'**id**, appelez la fonction **addTask**.

```typescript
submit() {
    const id = this.route.snapshot.paramMap.get('id');

    if (id) {
      const existingTask = this.taskService.getTask(id);
      this.taskService.updateTask({
        ...existingTask,
        ...this.task
      });
    } else {
      this.taskService.addTask(this.task);
    }
    this.router.navigate(['/']);
  }
```

Dans les deux cas, revenez √† la liste des t√¢ches.

### üéì Instructions

<Steps>

1. Mettez √† jour le fichier `src/app/task-form/task-form.component.ts`.

   ```typescript ins={"Ajoutez la fonction updateTask": 28-42}
   import { Component, OnInit } from '@angular/core';
   import { ActivatedRoute } from '@angular/router';
   import { TaskService } from '../task.service';
   import { Task } from '../task.model';

   @Component({
     selector: 'app-task-form',
     templateUrl: './task-form.component.html',
     styleUrls: ['./task-form.component.css']
   })
   export class TaskFormComponent implements OnInit {
       task: TaskForm = {
           title: '',
           description: ''
       };

     constructor(
       private route: ActivatedRoute,
       private taskService: TaskService
     ) {}

     ngOnInit() {
         const id = this.route.snapshot.paramMap.get('id');
         if (id) {
             this.task = this.taskService.getTask(id);
         }
     }

        submit() {
            const id = this.route.snapshot.paramMap.get('id');

            if (id) {
                const existingTask = this.taskService.getTask(id);
                this.taskService.updateTask({
                    ...existingTask,
                    ...this.task
                });
            } else {
                this.taskService.addTask(this.task);
            }
            this.router.navigate(['/']);
        }
   }
   ```

</Steps>

## Testez-le

<Steps>

1. Cliquez sur le bouton `Mettre √† jour` √† c√¥t√© d'une t√¢che dans la liste.
2. Mettez √† jour le formulaire avec les nouveaux d√©tails de la t√¢che.
3. Cliquez sur le bouton `Mettre √† jour la t√¢che`.
4. La t√¢che doit √™tre mise √† jour dans la liste.

</Steps>

## ‚úîÔ∏è Ce que vous avez appris

Dans ce chapitre, vous avez appris √† mettre √† jour **TaskFormComponent** pour g√©rer √† la fois la mise √† jour et la cr√©ation de t√¢ches.
